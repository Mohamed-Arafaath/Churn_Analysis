# Python Code for Telecom Churn Analysis Project

This folder contains all the Python scripts and related files used for predictive analysis in the **Telecom Churn Analysis Project**. The scripts leverage libraries such as Pandas, NumPy, and Scikit-learn to preprocess data, train machine learning models, and generate predictions for customer churn.

---

## **Key Objectives**

- To preprocess the input customer data (`Prediction_Data.xlsx`) for predictive modeling by cleaning and encoding the data.
- To develop a machine learning model that predicts customer churn probabilities and classifications.
- To generate actionable insights from predictions for integration into Power BI dashboards.
- To save the prediction results (`Predictions_output.csv`) for further analysis and visualization.
- To create a reusable and modular Python script (`churn_prediction.py`) for predictive analytics.

---

## **Python Code Overview**

### 1. **Prediction_Data.xlsx**:
   - This file serves as the source dataset for churn prediction.
   - It was generated by combining two database views:
     - **`vw_ChurnData`**: Data for existing customers with statuses "Churned" or "Stayed."
     - **`vw_JoinData`**: Data for joined customers with status "Joined."
   - Both views were inserted as separate sheets in `Prediction_Data.xlsx` using Python.

   **Sheets in Prediction_Data.xlsx**:
   - **Existing_Customers**: Contains data from `vw_ChurnData`.
   - **Joined_Customers**: Contains data from `vw_JoinData`.

   **Features in the Dataset**:
   - **Demographic Information**: Age, Gender, Marital Status.
   - **Account Details**: Tenure, Monthly Charges, Total Charges.
   - **Service Usage**: Internet Service, Phone Service, Additional Services.
   - **Identifiers**: Customer IDs for mapping predictions.

---

### 2. **Predictions_output.csv**:
   - This file contains the results of the churn prediction model.
   - Key columns include:
     - **Customer_ID**: Unique identifier for each customer.
     - **Predicted_Churn_Probability**: Probability score (0 to 1) indicating the likelihood of churn.
     - **Predicted_Churn**: Binary classification (0 for non-churn, 1 for churn).

   **Example Output**:
   | Customer_ID | Predicted_Churn_Probability | Predicted_Churn |
   |-------------|-----------------------------|-----------------|
   | 11098-MAD   | 0.87                        | 1               |
   | 11227-UTT   | 0.15                        | 0               |

---

### 3. **Python Code**:
   - **`churn_prediction.py`**: The script that performs the following:
     - Loads and preprocesses the `Prediction_Data.xlsx` file.
     - Trains a machine learning model (Random Forest Classifier) for churn prediction.
     - Generates predictions and exports results to `Predictions_output.csv`.

---

## **Key Steps in Python Code**

### **1. Data Preprocessing**
- Loaded data from `Prediction_Data.xlsx` (both sheets: `Existing_Customers` and `Joined_Customers`).
- Cleaned the data:
  - Handled missing values.
  - Encoded categorical features (e.g., Gender, Payment Methods).
  - Scaled numerical features (e.g., Monthly Charges, Total Charges).
- Combined data from both sheets for model training.

### **2. Model Training**
- Used a **Random Forest Classifier** to predict churn probabilities.
- Split the data into training (80%) and testing (20%) sets for evaluation.
- Performed hyperparameter tuning to optimize model accuracy.

### **3. Generating Predictions**
- Generated predictions for churn probabilities and classifications.
- Exported predictions to `Predictions_output.csv`.

---

## **How to Use**

1. Ensure the `Prediction_Data.xlsx` file is in the folder:
   - This file already contains data from `vw_ChurnData` and `vw_JoinData`.

2. Run the Python script (`churn_prediction.py`) using Python 3.8 or higher:
   ```bash
   python churn_prediction.py

    ```
3. The output file `Predictions_output.csv` will be generated in the same directory.

---

**Dependencies**  
Install the required Python libraries before running the script:
```bash
pip install pandas numpy scikit-learn openpyxl
```

---

## References

### SQL Data Source:
- The data in `Prediction_Data.xlsx` was created using the database views:
  - **`vw_ChurnData`**: For existing customers ("Churned" or "Stayed").
  - **`vw_JoinData`**: For joined customers ("Joined").
- These views are defined in the SQL folder: [`SQL/SQL_Queries.sql`](../SQL/SQL_Queries.sql).

### BI Integration:
- Predictions from `Predictions_output.csv` are integrated into the Power BI dashboards located in the [`BI`](../BI) folder.

---

**Folder Structure**
```plaintext
Python/
├── readme.md              # Documentation file
├── churn_prediction.py    # Python script for prediction
├── Prediction_Data.xlsx   # Input data
├── Predictions_output.csv # Predicted churn data


